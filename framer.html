<div id="pfp-preview-tool">
  <!-- Previous HTML remains unchanged -->
</div>

<style>
  /* Previous styles remain unchanged */
</style>

<script>
  (function() {
    // Previous code remains unchanged up to the applyFrameStyle function

    function applyFrameStyle(style, width) {
      const baseWidth = width === 'thin' ? 10 : width === 'medium' ? 20 : 30;
      let borderStyle = 'solid';
      let borderImage = 'none';
      let boxShadow = 'none';
      let transform = 'none';

      switch (style) {
        case 'classic':
          borderStyle = 'double';
          boxShadow = `inset 0 0 0 ${baseWidth/2}px ${frameColor.value}, 0 0 0 ${baseWidth}px ${frameColor.value}`;
          break;
        case 'modern':
          borderStyle = 'solid';
          boxShadow = `0 0 0 ${baseWidth}px ${frameColor.value}, 0 0 0 ${baseWidth + 5}px #fff, 0 0 10px rgba(0,0,0,0.2)`;
          break;
        case 'ornate':
          borderImage = `url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='200' viewBox='0 0 200 200'%3E%3Cdefs%3E%3Cfilter id='gold' color-interpolation-filters='sRGB'%3E%3CfeComponentTransfer%3E%3CfeFuncR type='table' tableValues='0.97 0.96 0.90'/%3E%3CfeFuncG type='table' tableValues='0.78 0.74 0.62'/%3E%3CfeFuncB type='table' tableValues='0.23 0.22 0.16'/%3E%3C/feComponentTransfer%3E%3C/filter%3E%3C/defs%3E%3Cpath fill='${frameColor.value}' filter='url(%23gold)' d='M20,20 h160 v160 h-160z M30,30 h140 v140 h-140z'/%3E%3Cg fill='none' stroke='%23fff' stroke-width='1'%3E%3Cpath d='M35,35 h130 v130 h-130z'/%3E%3Cpath d='M40,40 h120 v120 h-120z'/%3E%3C/g%3E%3Cg fill='%23fff' opacity='0.7'%3E%3Ccircle cx='20' cy='20' r='10'/%3E%3Ccircle cx='180' cy='20' r='10'/%3E%3Ccircle cx='20' cy='180' r='10'/%3E%3Ccircle cx='180' cy='180' r='10'/%3E%3C/g%3E%3Cpath fill='none' stroke='%23fff' stroke-width='2' d='M60,20 Q100,60 140,20 M20,60 Q60,100 20,140 M60,180 Q100,140 140,180 M180,60 Q140,100 180,140'/%3E%3Cpath fill='none' stroke='%23fff' stroke-width='1' d='M65,25 Q100,65 135,25 M25,65 Q65,100 25,135 M65,175 Q100,135 135,175 M175,65 Q135,100 175,135'/%3E%3C/svg%3E") 100 stretch`;
          boxShadow = '0 0 20px rgba(0,0,0,0.3)';
          break;
        case 'minimal':
          borderStyle = 'solid';
          boxShadow = '0 0 10px rgba(0,0,0,0.1)';
          break;
        case 'wood':
          borderImage = `url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='200' viewBox='0 0 200 200'%3E%3Cfilter id='noise' x='0' y='0'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.75' numOctaves='5' stitchTiles='stitch'/%3E%3CfeColorMatrix type='saturate' values='0'/%3E%3C/filter%3E%3Crect width='200' height='200' fill='${frameColor.value}'/%3E%3Crect width='200' height='200' filter='url(%23noise)' opacity='0.1'/%3E%3Cg fill='none' stroke='%23000' stroke-width='0.5' stroke-opacity='0.05'%3E%3Cpath d='M0,20 Q50,10 100,20 T200,20'/%3E%3Cpath d='M0,40 Q50,30 100,40 T200,40'/%3E%3Cpath d='M0,60 Q50,50 100,60 T200,60'/%3E%3Cpath d='M0,80 Q50,70 100,80 T200,80'/%3E%3Cpath d='M0,100 Q50,90 100,100 T200,100'/%3E%3Cpath d='M0,120 Q50,110 100,120 T200,120'/%3E%3Cpath d='M0,140 Q50,130 100,140 T200,140'/%3E%3Cpath d='M0,160 Q50,150 100,160 T200,160'/%3E%3Cpath d='M0,180 Q50,170 100,180 T200,180'/%3E%3C/g%3E%3C/svg%3E") 100 stretch`;
          boxShadow = '5px 5px 10px rgba(0,0,0,0.2)';
          break;
        case 'metal':
          borderImage = `linear-gradient(45deg, ${frameColor.value}, #fff, ${frameColor.value}) 1`;
          boxShadow = `inset 0 0 10px rgba(0,0,0,0.5), 0 0 10px rgba(0,0,0,0.2)`;
          break;
        case 'floating':
          borderStyle = 'none';
          boxShadow = '0 10px 20px rgba(0,0,0,0.3)';
          transform = 'perspective(1000px) rotateX(5deg)';
          break;
      }

      Object.assign(frame.style, {
        borderWidth: style === 'floating' ? '0' : `${baseWidth}px`,
        borderStyle: borderStyle,
        borderImage: borderImage,
        borderColor: frameColor.value,
        boxShadow: boxShadow,
        transform: transform
      });
    }

    // Rest of the code remains unchanged
  })();
</script>
