<div id="pfp-preview-tool">
  <h2>Frame Previews</h2>
  <div id="pfp-image-upload">
    <input type="file" id="pfp-image-input" accept="image/*">
    <p>or</p>
    <input type="text" id="pfp-image-url" placeholder="Enter image URL">
    <button id="pfp-load-image">Load Image</button>
  </div>
  <div id="pfp-preview-container">
    <div id="pfp-frame">
      <div id="pfp-mat">
        <div id="pfp-image-container">
          <img id="pfp-preview-image" src="https://via.placeholder.com/400x300" alt="Preview">
        </div>
      </div>
    </div>
  </div>
  <div id="pfp-controls">
    <h3>Customize Frame</h3>
    <label for="pfp-frame-style">Frame Style:</label>
    <select id="pfp-frame-style">
      <option value="classic">Classic</option>
      <option value="modern">Modern</option>
      <option value="rustic">Rustic</option>
      <option value="ornate">Ornate</option>
      <option value="minimal">Minimal</option>
    </select>
    <label for="pfp-frame-width">Frame Width:</label>
    <select id="pfp-frame-width">
      <option value="thin">Thin</option>
      <option value="medium" selected>Medium</option>
      <option value="thick">Thick</option>
    </select>
    <label for="pfp-frame-color">Frame Color:</label>
    <input type="color" id="pfp-frame-color" value="#000000">
    <label for="pfp-mat-color">Mat Color:</label>
    <input type="color" id="pfp-mat-color" value="#FFFFFF">
    <label for="pfp-mat-width">Mat Width:</label>
    <input type="range" id="pfp-mat-width" min="0" max="100" value="50">
  </div>
</div>

<style>
  #pfp-preview-tool {
    max-width: 800px;
    margin: 0 auto;
    padding: 20px;
    font-family: Arial, sans-serif;
  }
  #pfp-image-upload {
    margin-bottom: 20px;
    text-align: center;
  }
  #pfp-preview-container {
    position: relative;
    width: 100%;
    padding-bottom: 75%; /* 4:3 aspect ratio */
    margin-bottom: 20px;
  }
  #pfp-frame {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: 20px solid #000;
    box-sizing: border-box;
  }
  #pfp-mat {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #fff;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  #pfp-image-container {
    position: relative;
    max-width: 100%;
    max-height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
  }
  #pfp-preview-image {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
  }
  #pfp-controls {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    align-items: center;
  }
  #pfp-controls label {
    margin-right: 5px;
  }
  #pfp-frame-style,
  #pfp-frame-width,
  #pfp-frame-color,
  #pfp-mat-color,
  #pfp-mat-width {
    margin-right: 15px;
  }
</style>

<script>
  (function() {
    const imageInput = document.getElementById('pfp-image-input');
    const imageUrl = document.getElementById('pfp-image-url');
    const loadButton = document.getElementById('pfp-load-image');
    const previewImage = document.getElementById('pfp-preview-image');
    const frameStyle = document.getElementById('pfp-frame-style');
    const frameWidth = document.getElementById('pfp-frame-width');
    const frameColor = document.getElementById('pfp-frame-color');
    const matColor = document.getElementById('pfp-mat-color');
    const matWidth = document.getElementById('pfp-mat-width');
    const frame = document.getElementById('pfp-frame');
    const mat = document.getElementById('pfp-mat');
    const imageContainer = document.getElementById('pfp-image-container');

    function loadImage(src) {
      const img = new Image();
      img.onload = function() {
        previewImage.src = src;
        updateMat(); // Ensure mat is updated after image load
      };
      img.src = src;
    }

    imageInput.addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          loadImage(e.target.result);
        };
        reader.readAsDataURL(file);
      }
    });

    loadButton.addEventListener('click', function() {
      const url = imageUrl.value.trim();
      if (url) {
        loadImage(url);
      }
    });

    function updateFrame() {
      const style = frameStyle.value;
      const width = frameWidth.value;
      frame.className = `frame ${style} ${width}`;
      applyFrameStyle(style, width);
    }

    function updateMat() {
      mat.style.backgroundColor = matColor.value;
      const width = parseInt(matWidth.value);
      imageContainer.style.width = imageContainer.style.height = `calc(100% - ${width * 2}px)`;
    }

    frameStyle.addEventListener('change', updateFrame);
    frameWidth.addEventListener('change', updateFrame);
    frameColor.addEventListener('input', updateFrame);
    matColor.addEventListener('input', updateMat);
    matWidth.addEventListener('input', updateMat);

    // Frame style presets
    function applyFrameStyle(style, width) {
      const baseWidth = width === 'thin' ? 10 : width === 'medium' ? 20 : 30;
      let borderStyle = 'solid';
      let borderImage = 'none';

      switch (style) {
        case 'modern':
          borderStyle = 'solid';
          break;
        case 'rustic':
          borderStyle = 'ridge';
          break;
        case 'ornate':
          borderStyle = 'solid';
          borderImage = `url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='75' height='75' viewBox='0 0 75 75'%3E%3Cpath d='M0 0h75v75H0z' fill='${frameColor.value}'/%3E%3Cpath d='M37.5 15L15 37.5 37.5 60 60 37.5z' fill='%23fff'/%3E%3C/svg%3E") 25% repeat`;
          break;
        case 'minimal':
          borderStyle = 'solid';
          frame.style.boxShadow = '0 0 10px rgba(0,0,0,0.1)';
          break;
        default: // classic
          borderStyle = 'solid';
          frame.style.boxShadow = 'none';
      }

      Object.assign(frame.style, {
        borderWidth: `${baseWidth}px`,
        borderStyle: borderStyle,
        borderImage: borderImage,
        borderColor: frameColor.value
      });
    }

    // Initial update
    updateFrame();
    updateMat();
  })();
</script>
